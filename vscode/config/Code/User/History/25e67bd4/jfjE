CC = gcc
CFLAGS = -Wall -g 
COMPILE = -c
OUTPUT = -o
OUTPATH = build
APPLICATION = automata
LIBS = 
CMD_RUN = ./$(OUTPATH)/\$(APPLICATION)

define run_std_compilation
	$(CC) $(CFLAGS) $(COMPILE) $< $(OUTPUT) $(OUTPATH)/$@ $(LIBS)
endef

SRCS = $(wildcard */*/*.cpp) $(wildcard */*.cpp) $(wildcard *.cpp) 
OBJS = $(patsubst %.cpp,%.o,$(SRCS))
OBJS_FILES = $(patsubst %.o,$(OUTPATH)/%.o,$(OBJS))

all: compile link start

link: 
	$(CC) $(CFLAGS) $(OUTPUT) \
		$(OUTPATH)/$(APPLICATION) \
		$(OUTPATH)/main.o \
		$(LIBS)

start: 
	$(CMD_RUN)

compile: prepare $(OBJS)

%.o: %.cpp
	$(call run_std_compilation)

prepare:


clear: 
	rm -rf out/*